---
title: "Simulation, Functions, and Loops"
author: ""
format: 
  revealjs:
    theme: night
    slide-number: true
    show-slide-number: all
    chalkboard: false # Great for drawing during stats lectures
    incremental: false # Bullet points appear one by one
    embed-resources: true
editor_options: 
  chunk_output_type: console
---

# Check In

# Data Simulation

## Step 1: Set Seed


***Whenever one uses a random process, one must set the seed.***


```{r}
#| echo: true

set.seed(1991)
```


## Make Some Data

* **Probability Distributions** 
  *   `rnorm()`, `rpois()`, `rbinom()`, `rexp()`, ...

:::{.panel-tabset}

## Code

```{r}
#| echo: true
#| eval: false
set.seed(1000478)

number_of_observations <- 5
simulated_data <-
  data.frame(
    person = c(1:number_of_observations),
    std_normal_observations = rnorm(
      n = number_of_observations,
      mean = 0,
      sd = 1
    )
  )

simulated_data
```

## Output

```{r}
#| echo: false

set.seed(1000478)

number_of_observations <- 5
simulated_data <-
  data.frame(
    person = c(1:number_of_observations),
    std_normal_observations = rnorm(
      n = number_of_observations,
      mean = 0,
      sd = 1
    )
  )

simulated_data
```

:::

## More Data!

::: {.panel-tabset}

## Code

```{r}
#| echo: true
#| eval: false

simulated_data <-
  simulated_data |>
  cbind() |>
  data.frame(
    uniform_observations =
      runif(n = number_of_observations, min = 0, max = 10),
    poisson_observations =
      rpois(n = number_of_observations, lambda = 100),
    binomial_observations =
      rbinom(n = number_of_observations, size = 2, prob = 0.5)
  )

simulated_data
```

## Output

```{r}
#| echo: false
#| eval: true

simulated_data <-
  simulated_data |>
  cbind() |>
  data.frame(
    uniform_observations =
      runif(n = number_of_observations, min = 0, max = 10),
    poisson_observations =
      rpois(n = number_of_observations, lambda = 100),
    binomial_observations =
      rbinom(n = number_of_observations, size = 2, prob = 0.5)
  )

simulated_data
```

:::

## What if I want to draw names out of a hat?

```{r}
#| echo: true

atlantis <- c("kida", "milo", "helga", "audrey", "gaetan")
atlantis
```

```{r}
#| echo: true

sample(x = atlantis, size = 3, replace = T)
```

## Putting It all Together

:::{.panel-tabset}

## Code

```{r}
#| echo: true
#| eval: false

simulated_data <-
  data.frame(
    favorite_color = sample(
      x = c("blue", "white"),
      size = number_of_observations,
      replace = TRUE
    )
  ) |>
  cbind(simulated_data)

simulated_data
```

## Output

```{r}
#| echo: false
#| eval: true

simulated_data <-
  data.frame(
    favorite_color = sample(
      x = c("blue", "white"),
      size = number_of_observations,
      replace = TRUE
    )
  ) |>
  cbind(simulated_data)

simulated_data
```

:::

# Writing Functions

> R is a functional programming language. 

##

:::{.panel-tabset}

## Skeleton

```{r}
#| echo: true
#| eval: false

name <- function(arguments){
  body
}
```

## Basic

```{r}
#| echo: true

print_names <- function(some_names) {
  print(some_names)
}

print_names(c("rohan", "monica"))
```

## With Defaults

```{r}
#| echo: true


print_names <- function(some_names = c("edward", "hugo")) {
  print(some_names)
}

print_names()
```

:::

##

```{r}
#| echo: true
#| message: false

library(tidyverse)

df <- tibble(
  a = rnorm(5),
  b = rnorm(5),
  c = rnorm(5),
  d = rnorm(5))

df
```

##

```{r}
#| echo: true

df |> mutate(
  a = (a - min(a, na.rm = TRUE)) / 
    (max(a, na.rm = TRUE) - min(a, na.rm = TRUE)),
  b = (b - min(a, na.rm = TRUE)) / 
    (max(b, na.rm = TRUE) - min(b, na.rm = TRUE)),
  c = (c - min(c, na.rm = TRUE)) / 
    (max(c, na.rm = TRUE) - min(c, na.rm = TRUE)),
  d = (d - min(d, na.rm = TRUE)) / 
    (max(d, na.rm = TRUE) - min(d, na.rm = TRUE)))
```

**To much repetition.**

## Replace with a Function

```{r}
#| echo: true

rescale01 <- function(x) {
  (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
}
```

**Test first!**

```{r}
#| echo: true

rescale01(c(-10, 0, 10))
rescale01(c(1, 2, 3, NA, 5))
```

##

```{r}
#| echo: true

# rescale01 <- function(x) {
  # (x - min(x, na.rm = TRUE)) / (max(x, na.rm = # TRUE) - min(x, na.rm = TRUE))
#}

df |> mutate(
  a = rescale01(a),
  b = rescale01(b),
  c = rescale01(c),
  d = rescale01(d))

```

## Functions will make your life easier

```{r}
#| echo: true

mape <- function(actual, predicted) {
  sum(abs((actual - predicted) / actual)) / length(actual)
}
```

```{r}
#| echo: true

JARVIS <- function(speak){
  print(c("I am Ironman."))
}

JARVIS(speak)
```

# Conditional Statements

```{r}
#| echo: true
#| eval: false

  if (condition) {
    Code executed when condition is TRUE
  } else {
    Code executed when condition is FALSE
  }
```

##

```{r}
#| echo: true

a <- 4  # Set value for a
if (a > 0) {
  print("positive")
}
```

```{r}
#| echo: true

a <- -3
if (a > 0) {
  print("positive")
} else {
  print("negative")
}
```

```{r}
#| echo: true

a <- 0
if (a > 0) {
  print("positive")
} else if (a < 0) {
  print("negative")
} else if (a == 0) {
  print("zero")
} else {
  print("Houston, we have a problem.")
}
```

## Simplify 

```{r}
#| echo: true

age <- 3
ifelse(age >= 18, "adult", "child")
```

# While Loops

# For Loops

* A fundamental component to programming is the ability to iterate over task(s).

```{r}
#| echo: true
#| eval: false

for (element in vector) {
  # do something with element
}
```

## 

```{r}
#| echo: true

for (i in 1:5) {
  print(i)
}
```

```{r}
#| echo: true

for (i in 1:5) {
  print(i + 1)
}
```

```{r}
#| echo: true

index <- c(1, 3, 5, 7, 9)
for(i in index) print(i)
```

## Breaking a Loop

```{r}
#| echo: true

index <- c(1, 3, 5, 7, 9)
for(i in index) {
  print(i)
  if(i > 5) break
}
```

## Making it difficult

```{r}
#| echo: true

my_matrix <- matrix(data = 1, nrow = 5, ncol = 5)
my_matrix
```

```{r}
#| echo: true

for(i in 1:nrow(my_matrix)){
  for(j in 1:ncol(my_matrix)){
    my_matrix[i, j] <- (i-1)*5 + j
  }  
}
my_matrix
```

# While loops

**PSA: Be careful about your conditions!**

```{r}
#| echo: true

i <- 0
while (i <= 4) {
  i <- i + 1
  print(i)
}
```

# The `apply` family

* `apply()`, `lapply()`, `tapply()`, `sapply()`, `vapply()`

```{r}
#| echo: true
#| eval: false

lapply(X, FUN)
```

```{r}
#| echo: true

lapply(0:4, function(a) {a + 1})
```

